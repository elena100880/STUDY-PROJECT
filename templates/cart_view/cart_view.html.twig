{% extends 'base.html.twig' %}

{% block stylesheets1 %}
    <link rel="stylesheet" href="/css/cart_view.css">
{% endblock %}

{% block content %}           

    <h1>YOUR CART</h1>      

    {{form_start(form)}}           
            <table>

                <tr>
                    <th>SN</th> <th>ID</th> <th>Product</th>  <th>Price</th> <th> - 1</th> <th>Quantity</th> <th> + 1</th> <th>Sum</th> <th> Delete the whole position </th> 
                </tr>

                {% set i = 0 %}
                {% set sum = 0 %}
                
                {% for orderProduct in arrayOfOrderProductsInCart %}
                <tr>

                    <td align = 'center'> {% set i = i + 1 %} {{i}}</td>
                    <td align = 'center'> {{orderProduct.products.id}} </td>
                    <td align = 'center'> {{orderProduct.products}} </td>
                    <td align = 'center'> {{orderProduct.products.price}} </td>
                    <td align = 'center'> <a class="button" href="{{ path('product_fromcart', {id :orderProduct.products.id}) }}"><span class="plus">  &#8722  </span></a><br> </td>

                    <td align = 'center'> 
                        
                    {#    {{orderProduct.amount}}      #}

                        {% for amount in form.amounts %}  

                            {% if loop.index == i %}
                            
                                {{form_widget  (amount) }}

                            {% endif %}
                                
                        {% endfor %}  

                    </td>

                    <td align = 'center'> <a class="button" href="{{ path('product_tocart', {id :orderProduct.products.id}) }}"><span class="plus"> + </span></a> </td>

                    <td align = 'center'> 
                            {{orderProduct.getTotalValue}} 
                            {% set sum = sum + orderProduct.products.price * orderProduct.amount %} 
                    </td>

                    <td align = 'center'> 

                    {#    <a class="button" href="{{ path('delete_whole_product_from_cart',  {id :orderProduct.products.id}) }}"> <span class="plus"> &#x2718 </span> </a>    #}

                        {% for delete in form.delete_products %}  

                            {% if loop.index == i %}
                            
                                {{form_widget (delete) }}

                            {% endif %}
                                
                        {% endfor %}      

                    </td>

                </tr>
                {% endfor %}

            </table>
            <br>


    {#    {{form_start(form)}}

            {{form_row  (form.amounts,  {    
                                            
                                        }, 
                        ) }}    
                        
            {{form_row  (form.delete_product,   {    
                                                    'required': false,
                                                }, 
                        ) }}       #}     
            
            <div class = 'form'>
                {{form_row(form.send)}}
            </div>

            <div class = 'form'>
                {{form_row(form.refresh)}}
            </div>
            
            <div class = 'form'>
                {{form_row(form.reset)}}
            </div>
            <div style = 'clear:both'></div>

        {{form_end(form)}}


    <h4>Total sum:   <span class="plus"> {{ sum }} z≈Ç. </span> </h4> <br>

    {#    {{form_row  (form.amount, {   'required': false,
                                    'attr': {'class': 'task_field'} 
                                } 
                    ) }}    

        {{form_label(form.amount)}}
        {{form_errors(form.amount)}}
        {{form_help(form.amount) }}       #}      
 
                        
    {#    {{ form.amount.vars.id }}         #}        

    <br><br><a href="{{ path('products') }}">  BACK TO THE LIST OF PRODUCTS >> </a>

{% endblock %}
